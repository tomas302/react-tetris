(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,t,a){e.exports=a(66)},30:function(e,t,a){},32:function(e,t,a){},38:function(e,t,a){},48:function(e,t,a){},50:function(e,t,a){},52:function(e,t,a){},54:function(e,t,a){},56:function(e,t,a){},58:function(e,t,a){},60:function(e,t,a){},62:function(e,t,a){},64:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(16),o=a.n(s),i=(a(30),a(2)),l=a(3),c=a(6),h=a(4),u=a(5),m=a(1),p=(a(32),a(7)),d=a(11),v=a(14),f=(a(38),a(10)),b=a.n(f),E=(a(48),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).handleOpenModal=a.handleOpenModal.bind(Object(m.a)(Object(m.a)(a))),a.handleCloseModal=a.handleCloseModal.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleOpenModal",value:function(){this.props.handler()}},{key:"handleCloseModal",value:function(e){this.props.handler()}},{key:"render",value:function(){var e,t;return this.props.isMobile?r.a.createElement(r.a.Fragment,null):(e=r.a.createElement("div",{id:"ControlInformation"},r.a.createElement("h3",null,r.a.createElement("u",null,"HOW TO PLAY")),r.a.createElement("ul",null,r.a.createElement("li",null,"MOVE: ",r.a.createElement("i",{className:"fas fa-arrow-left"})," ",r.a.createElement("i",{className:"fas fa-arrow-right"})),r.a.createElement("li",null,"ROTATE: ",r.a.createElement("i",{className:"fas fa-arrow-up"})),r.a.createElement("li",null,"FALL FASTER: ",r.a.createElement("i",{className:"fas fa-arrow-down"})),r.a.createElement("li",null,"HARD DROP: Space"),r.a.createElement("li",null,"HOLD: C"))),t=this.props.startScreen?r.a.createElement("button",{onClick:this.handleOpenModal,id:"OpenControlsButton",className:"btn btn-warning start-screen"},"HOW TO PLAY"):r.a.createElement("button",{onClick:this.handleOpenModal,id:"OpenControlsButton",className:"btn btn-warning"},r.a.createElement("i",{className:"fas fa-book"})),r.a.createElement("div",null,t,r.a.createElement(b.a,{ariaHideApp:!1,isOpen:this.props.open,contentLabel:"HOW TO PLAY",className:"ControlsModal",overlayClassName:"ControlsOverlay"},e,r.a.createElement("button",{id:"CloseControlsButton",className:"btn btn-danger",onClick:this.handleCloseModal},"BACK"))))}}]),t}(r.a.Component)),O=function(e){return r.a.createElement("div",{className:"cell "+e.matrix[e.x][e.y].tetromino+(e.matrix[e.x][e.y].ghost?" ghost":"")})};var g=Object(p.b)(function(e){return{matrix:e.matrix}})(O),y=10,w=15,j=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).state={matrix:[]};for(var n=[],s=0;s<w;s++){for(var o=[],l=0;l<y;l++)o.push(r.a.createElement(g,{key:l*y+s*w,x:l,y:s}));n.push(o)}return a.state.matrix=n,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"Matrix"},this.state.matrix)}}]),t}(n.Component);var T=Object(p.b)(function(e){return{matrix:e.matrix}})(j),k=function(e){return{type:"RESET_GAME_STATE",gameKey:e}},N=function(e,t,a){return{type:"CHANGE_MATRIX",cells:e,tetromino:t,ghost:a}},C=function(e){return{type:"ADD_SCORE",points:e}},S=function(e,t){return{type:"START_TIMER",delay:e,fn:t}},R=["I","J","L","O","S","T","Z"],A={I:[[[0,0],[1,0],[-1,0],[-2,0]],[[0,0],[0,-1],[0,1],[0,2]],[[0,1],[1,1],[-1,1],[-2,1]],[[-1,0],[-1,-1],[-1,1],[-1,2]]],J:[[[0,0],[1,0],[-1,0],[-1,-1]],[[0,0],[0,-1],[1,-1],[0,1]],[[0,0],[-1,0],[1,0],[1,1]],[[0,0],[0,1],[-1,1],[0,-1]]],L:[[[0,0],[-1,0],[1,0],[1,-1]],[[0,0],[0,-1],[0,1],[1,1]],[[0,0],[1,0],[-1,0],[-1,1]],[[0,0],[0,-1],[-1,-1],[0,1]]],O:[[[0,0],[0,1],[-1,1],[-1,0]],[[0,0],[0,1],[-1,1],[-1,0]],[[0,0],[0,1],[-1,1],[-1,0]],[[0,0],[0,1],[-1,1],[-1,0]]],S:[[[0,0],[1,-1],[0,-1],[-1,0]],[[0,0],[0,-1],[1,0],[1,1]],[[0,0],[1,0],[0,1],[-1,1]],[[0,0],[-1,-1],[-1,0],[0,1]]],T:[[[0,0],[1,0],[-1,0],[0,-1]],[[0,0],[0,-1],[0,1],[1,0]],[[0,0],[1,0],[-1,0],[0,1]],[[0,0],[0,-1],[0,1],[-1,0]]],Z:[[[0,0],[1,0],[0,-1],[-1,-1]],[[0,0],[1,-1],[1,0],[0,1]],[[0,0],[-1,0],[0,1],[1,1]],[[0,0],[-1,0],[-1,1],[0,-1]]]},M=function(e,t){if(e){if(e>10)throw Error("Why do you need so many Tetrominos??");var a=[],n=R.slice();if(void 0!==t)for(var r=0;r<n.length;r++)for(var s=0;s<t.length;s++)n[r]===t[s]&&n.splice(r,1);for(var o=0;o<e;o++){o%R.length===0&&0!==o&&(n=R.slice());var i=Math.floor(Math.random()*n.length);a.push(n[i]),n.splice(i,1)}return a}var l=R.slice();if(void 0!==t)for(var c=l.length-1;c>=0;c--){for(var h=!1,u=0;u<t.length;u++)if(l[c]===t[u]){h=!0;break}h&&l.splice(c,1)}return l[Math.floor(Math.random()*l.length)]},x=function(e){return{type:e,shape:A[e]}},I=function(e,t,a,n,r){var s=e.orientation;void 0!==n&&(s=n);var o=e.cells,i=e.ghostCells,l=e.type,c=e.tetrominoProps,h=[],u=[];return c.shape[s].forEach(function(e){h.push([t[0]+e[0],t[1]+e[1]]),u.push([t[0]+e[0],r+e[1]])}),a(N(o,"none")),a(N(i,"none",!0)),a(N(u,l,!0)),a(N(h,l)),[h,u]},D=(a(50),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"next-cell "+this.props.tetromino})}}]),t}(n.Component)),_=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=0,n=0;n<this.props.nextTetrominos.length;n++){for(var s=[],o=x(this.props.nextTetrominos[n]).shape[2],i="I"===this.props.nextTetrominos[n]?4:"O"===this.props.nextTetrominos[n]?2:3,l=function(t){for(var l=function(l){var c=!1;3===i?o.forEach(function(e){e[0]+1!==l||e[1]+1!==t||(c=!0)}):4===i?o.forEach(function(e){e[0]+2!==l||e[1]!==t||(c=!0)}):c=!0,a+=1,c?s.push(r.a.createElement(D,{key:a,tetromino:e.props.nextTetrominos[n]})):s.push(r.a.createElement(D,{key:a,tetromino:"none"}))},c=0;c<i;c++)l(c)},c=1;c<3;c++)l(c);t.push(r.a.createElement("div",{className:"next-matrix-"+i,key:n},s))}return r.a.createElement("div",{id:"NextBox"},r.a.createElement("h2",null,"NEXT"),r.a.createElement("div",{id:"next-box"},t))}}]),t}(n.Component);var P=Object(p.b)(function(e){return{nextTetrominos:e.nextTetrominos}})(_),H=(a(52),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"hold-cell "+this.props.tetromino})}}]),t}(n.Component)),G=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e;"none"!==this.props.tetrominoHeld&&(e=x(this.props.tetrominoHeld).shape[0]);for(var t=[],a="I"===this.props.tetrominoHeld?4:"O"===this.props.tetrominoHeld?2:3,n=0;n<2;n++){for(var s=[],o=0;o<a;o++){var i="none";if(e)for(var l=0;l<e.length;l++)switch(this.props.tetrominoHeld){case"I":e[l][0]+2===o&&e[l][1]+1===n&&(i=this.props.tetrominoHeld);break;case"O":e[l][0]+1===o&&e[l][1]===n&&(i=this.props.tetrominoHeld);break;default:e[l][0]+1===o&&e[l][1]+1===n&&(i=this.props.tetrominoHeld)}s.push(r.a.createElement(H,{key:3*n+4*o,tetromino:i}))}t.push(s)}return r.a.createElement("div",{id:"HoldBox"},r.a.createElement("h2",null,"HOLD"),r.a.createElement("div",{id:"holder"},r.a.createElement("div",{id:"hold-matrix-"+a},t)))}}]),t}(n.Component);var L=Object(p.b)(function(e){return{tetrominoHeld:e.holding}})(G),B=(a(54),function(e){return r.a.createElement("div",{id:"StatsBox"},r.a.createElement("div",{className:"col-xs-4 col-md-12"},r.a.createElement("h4",null,"SCORE"),r.a.createElement("div",{className:"stat"},e.score)),r.a.createElement("div",{className:"col-xs-4 col-md-12"},r.a.createElement("h4",null,"LEVEL"),r.a.createElement("div",{className:"stat"},e.level)),r.a.createElement("div",{className:"col-xs-4 col-md-12"},r.a.createElement("h4",null,"LINES"),r.a.createElement("div",{className:"stat"},e.lines)))});var F=Object(p.b)(function(e){return{score:e.stats.score,level:e.stats.level,lines:e.stats.lines}})(B),K=(a(56),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).handler=a.handler.bind(Object(m.a)(Object(m.a)(a))),a.handleCloseModal=a.handleCloseModal.bind(Object(m.a)(Object(m.a)(a))),a.handleBackToStart=a.handleBackToStart.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handler",value:function(){this.props.paused||this.props.handler()}},{key:"handleCloseModal",value:function(e){this.props.handler(e)}},{key:"handleBackToStart",value:function(){this.props.backToStart()}},{key:"render",value:function(){var e,t="";return this.props.paused?t=r.a.createElement("i",{className:"fas fa-play"}):e=r.a.createElement("i",{id:"PauseIcon",className:"fas fa-pause"}),r.a.createElement("div",{id:"PauseButton",className:(this.props.paused?"paused":"")+" unselectable",onClick:this.handler},e,r.a.createElement("b",null,t),r.a.createElement(b.a,{ariaHideApp:!1,isOpen:this.props.paused,contentLabel:"PAUSED",className:"PauseModal",overlayClassName:"PauseOverlay"},r.a.createElement("h1",null,"PAUSE"),r.a.createElement("div",{id:"PauseButtonGroup"},r.a.createElement("button",{className:"unselectable btn btn-success",onClick:this.handleCloseModal},r.a.createElement("i",{className:"fas fa-play"})),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"":r.a.createElement(E,{isMobile:this.props.isMobile,handler:this.props.controlHandler,open:this.props.openControls}),r.a.createElement("button",{className:"unselectable btn btn-info",onClick:this.handleBackToStart},r.a.createElement("i",{className:"fas fa-home"})))))}}]),t}(r.a.Component)),W=(a(58),function(e){var t=window.chrome,a=window.navigator,n=a.vendor,s="undefined"!==typeof window.opr,o=a.userAgent.indexOf("Edge")>-1;if(null!==t&&"undefined"!==typeof t&&"Google Inc."===n&&!1===s&&!1===o){var i=e.fullscreen?r.a.createElement("i",{className:"fas fa-compress-arrows-alt"}):r.a.createElement("i",{className:"fas fa-expand-arrows-alt"});return r.a.createElement("button",{id:"FullScreenButton",onClick:e.handler},i)}return r.a.createElement(r.a.Fragment,null)}),X=(a(60),function(e){var t=e.mute?r.a.createElement("i",{className:"fas fa-volume-mute"}):r.a.createElement("i",{className:"fas fa-volume-up"});return r.a.createElement("button",{id:"VolumeButton",onClick:e.handler},t)}),Y=(a(62),a(64),function(e){function t(e){var a;Object(i.a)(this,t);var n=(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).props.newRecord(),r=Object(v.a)(n,2),s=r[0],o=r[1];return a.state={isNewRecord:s,newPosition:o,name:""},a.setNewRecord=a.setNewRecord.bind(Object(m.a)(Object(m.a)(a))),a.onChange=a.onChange.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"setNewRecord",value:function(){this.state.isNewRecord&&(this.props.setNewRecord(this.state.name,this.state.newPosition),this.setState({isNewRecord:!1}))}},{key:"onChange",value:function(e){(""===e.target.value||/[a-zA-Z0-9]{0,3}/.test(e.target.value))&&this.setState({name:e.target.value})}},{key:"render",value:function(){if(this.state.isNewRecord)return r.a.createElement(b.a,{ariaHideApp:!1,isOpen:!0,contentLabel:"NEW RECORD",className:"NewRecordModal",overlayClassName:"NewRecordOverlay"},r.a.createElement("h1",null,"NEW RECORD!!!"),r.a.createElement("label",{htmlFor:"name"},"Your Name:"),r.a.createElement("input",{style:{textAlign:"center"},id:"name",type:"text",onChange:this.onChange,value:this.state.name}),r.a.createElement("button",{className:"unselectable btn btn-success",onClick:this.setNewRecord},r.a.createElement("i",{className:"fas fa-save"})));for(var e=this.props.data,t=[],a=0;a<e.length;a++)t.push(r.a.createElement("tr",{key:a},r.a.createElement("td",null,e[a].name),r.a.createElement("td",{style:{float:"right"}},e[a].score)));return r.a.createElement("div",null,r.a.createElement("h5",{style:{textAlign:"center"}},"LEADERBOARD"),r.a.createElement("table",{className:"table table-dark",style:{width:"250px"}},r.a.createElement("tbody",null,t)))}}]),t}(r.a.Component)),U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).handlePlayAgain=a.handlePlayAgain.bind(Object(m.a)(Object(m.a)(a))),a.handleStartScreen=a.handleStartScreen.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handlePlayAgain",value:function(){this.props.restartGameHandler()}},{key:"handleStartScreen",value:function(){this.props.startScreenHandler()}},{key:"render",value:function(){return this.props.gameOver?r.a.createElement("div",{id:"GameOver",className:"",onClick:this.handler},r.a.createElement(b.a,{ariaHideApp:!1,isOpen:this.props.gameOver,contentLabel:"GAME OVER",className:"GameOverModal",overlayClassName:"GameOverOverlay"},r.a.createElement("h1",null,"GAME OVER"),r.a.createElement(Y,{data:this.props.leaderboardData,newRecord:this.props.newRecord,setNewRecord:this.props.setNewRecord}),r.a.createElement("p",null,r.a.createElement("b",null,"SCORE:")," ",this.props.score),r.a.createElement("p",null,r.a.createElement("b",null,"LEVEL:")," ",this.props.level),r.a.createElement("p",null,r.a.createElement("b",null,"LINES:")," ",this.props.lines),r.a.createElement("div",{id:"GameOverButtonGroup"},r.a.createElement("button",{className:"unselectable btn btn-success",onClick:this.handlePlayAgain},r.a.createElement("i",{className:"fas fa-redo-alt"})),r.a.createElement("button",{className:"unselectable btn btn-secondary",onClick:this.handleStartScreen},r.a.createElement("i",{className:"fas fa-home"}))))):r.a.createElement(r.a.Fragment,null)}}]),t}(r.a.Component);var J=Object(p.b)(function(e){return{score:e.stats.score,level:e.stats.level,lines:e.stats.lines}})(U),z=a(8),V=a.n(z),Z=function(e){function t(e){var a;Object(i.a)(this,t),a=Object(c.a)(this,Object(h.a)(t).call(this,e));var n=localStorage.getItem("reactTetris")?JSON.parse(localStorage.getItem("reactTetris")):{mute:!1,leaderboard:[{name:"",score:6e3},{name:"",score:5e3},{name:"",score:4e3},{name:"",score:3e3},{name:"",score:2e3}]};return a.state={storage:n,running:!1,isMobile:window.innerWidth<768,fullscreen:!1,gameOver:!1,paused:!1,mute:n.mute,showingControls:!1,tetromino:{},rotate:!1,canRotate:!0,moveX:0,pushDown:!1,waitingToHold:!1,dropHard:!1,timeDropped:Date.now(),lastTimeGravityWasApplied:Date.now()},a._music=r.a.createRef(),a.startGame=a.startGame.bind(Object(m.a)(Object(m.a)(a))),a.listenForGestures=a.listenForGestures.bind(Object(m.a)(Object(m.a)(a))),a.gameTick=a.gameTick.bind(Object(m.a)(Object(m.a)(a))),a.gameOver=a.gameOver.bind(Object(m.a)(Object(m.a)(a))),a.restartGame=a.restartGame.bind(Object(m.a)(Object(m.a)(a))),a.returnToStartMenu=a.returnToStartMenu.bind(Object(m.a)(Object(m.a)(a))),a.spawnNextTetromino=a.spawnNextTetromino.bind(Object(m.a)(Object(m.a)(a))),a.linesAchieved=a.linesAchieved.bind(Object(m.a)(Object(m.a)(a))),a.turnTetrominoIntoCells=a.turnTetrominoIntoCells.bind(Object(m.a)(Object(m.a)(a))),a.moveTetromino=a.moveTetromino.bind(Object(m.a)(Object(m.a)(a))),a.rotationCalculations=a.rotationCalculations.bind(Object(m.a)(Object(m.a)(a))),a.rotateTetromino=a.rotateTetromino.bind(Object(m.a)(Object(m.a)(a))),a.cleanCurrentTetromino=a.cleanCurrentTetromino.bind(Object(m.a)(Object(m.a)(a))),a.holdTetromino=a.holdTetromino.bind(Object(m.a)(Object(m.a)(a))),a.dropItHard=a.dropItHard.bind(Object(m.a)(Object(m.a)(a))),a.calculateGhostPieceY=a.calculateGhostPieceY.bind(Object(m.a)(Object(m.a)(a))),a.handlePauseButton=a.handlePauseButton.bind(Object(m.a)(Object(m.a)(a))),a.handleKeyDown=a.handleKeyDown.bind(Object(m.a)(Object(m.a)(a))),a.handleKeyUp=a.handleKeyUp.bind(Object(m.a)(Object(m.a)(a))),a.handleResize=a.handleResize.bind(Object(m.a)(Object(m.a)(a))),a.handleFullscreenClick=a.handleFullscreenClick.bind(Object(m.a)(Object(m.a)(a))),a.onFullscreenChange=a.onFullscreenChange.bind(Object(m.a)(Object(m.a)(a))),a.switchMute=a.switchMute.bind(Object(m.a)(Object(m.a)(a))),a.switchControls=a.switchControls.bind(Object(m.a)(Object(m.a)(a))),a.newRecord=a.newRecord.bind(Object(m.a)(Object(m.a)(a))),a.setNewRecord=a.setNewRecord.bind(Object(m.a)(Object(m.a)(a))),document.onfullscreenchange=a.onFullscreenChange,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this.handleKeyDown,!1),document.addEventListener("keyup",this.handleKeyUp,!1),window.addEventListener("resize",this.handleResize,!1);window.onunload=function(){localStorage.setItem("reactTetris",JSON.stringify(e.state.storage))},this.props.running&&this.startGame()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown,!1),document.removeEventListener("keyup",this.handleKeyUp,!1),window.removeEventListener("resize",this.handleResize,!1)}},{key:"startGame",value:function(){this.state.running||(this.setState({running:!0}),this.props.dispatch({type:"INIT_NEXT_TETROMINOS",currentTetro:this.spawnNextTetromino()}),this.props.dispatch(S(20,this.gameTick)))}},{key:"listenForGestures",value:function(e){var t=this,a=new V.a(e);a.add(new V.a.Swipe({event:"swipeup",direction:V.a.DIRECTION_UP})),a.add(new V.a.Swipe({event:"swipeleft",direction:V.a.DIRECTION_LEFT})),a.add(new V.a.Swipe({event:"swiperight",direction:V.a.DIRECTION_RIGHT})),a.add(new V.a.Swipe({event:"swipedown",direction:V.a.DIRECTION_DOWN}));a.on("doubletap",function(e){t.state.gameOver||-1===t.props.timer||t.state.waitingToHold||t.holdTetromino()});a.on("swipeup",function(e){t.state.gameOver||-1===t.props.timer||t.setState({rotate:!0})});a.on("swipeleft",function(e){t.state.gameOver||-1===t.props.timer||t.setState({moveX:-1})});a.on("swiperight",function(e){t.state.gameOver||-1===t.props.timer||t.setState({moveX:1})});a.on("swipedown",function(e){t.state.gameOver||-1===t.props.timer||t.setState({dropHard:!0})});a.on("press",function(e){t.state.gameOver||-1===t.props.timer||t.setState({pushDown:!0})});a.on("pressup",function(e){t.state.gameOver||-1===t.props.timer||t.setState({pushDown:!1})}),this._mc=a}},{key:"gameTick",value:function(){this.state.gameOver||(Date.now()-this.state.lastTimeGravityWasApplied>this.props.gravityInterval&&(this.moveTetromino(0,1),this.setState({lastTimeGravityWasApplied:Date.now()})),this.state.rotate&&(this.rotateTetromino(),this.setState({rotate:!1})),0!==this.state.moveX&&(this.moveTetromino(this.state.moveX,0),this.setState({moveX:0})),this.state.pushDown&&(this.props.dispatch(C(this.props.level)),this.moveTetromino(0,1)),this.state.dropHard&&(this.dropItHard(),this.setState({dropHard:!1})))}},{key:"gameOver",value:function(){this.props.dispatch({type:"STOP_TIMER"}),this.setState({running:!1,gameOver:!0})}},{key:"restartGame",value:function(){localStorage.setItem("reactTetris",JSON.stringify(this.state.storage)),this.props.dispatch(k(this.props.gameKey)),this.props.refreshApp(!0)}},{key:"returnToStartMenu",value:function(){this.setState({running:!1}),localStorage.setItem("reactTetris",JSON.stringify(this.state.storage)),this.props.dispatch(k(this.props.gameKey)),this.props.refreshApp(!1)}},{key:"spawnNextTetromino",value:function(e,t){var a=void 0===e?M():e,n=x(a),r={type:n.type,cells:[],ghostCells:[],ghostPosition:[],tetrominoProps:n,position:[5,"O"===n.type||"I"===n.type?0:1],orientation:0};if(r.cells=function(e,t,a,n,r){var s=e.orientation;void 0!==n&&(s=n);var o=e.cells,i=e.type,l=e.tetrominoProps,c=[];if(l.shape[s].forEach(function(e){c.push([t[0]+e[0],t[1]+e[1]])}),0===o.length){if(c.some(function(e){return"none"!==r[e[0]][e[1]].tetromino}))return!1}else a(N(o,"none"));return a(N(c,i)),c}(r,r.position,this.props.dispatch,0,this.props.matrix),!1!==r.cells){var s=this.calculateGhostPieceY(r,r.position);return r.ghostCells=this.getCellsByMoving(5,s,n),r.ghostPosition=[5,s],this.setState({tetromino:r,waitingToHold:void 0!==t&&t}),I(r,[5,r.position[1]],this.props.dispatch,0,this.calculateGhostPieceY(r,r.position)),n.type}this.gameOver()}},{key:"linesAchieved",value:function(e){for(var t=[],a=0;a<y;a++){for(var n=[],r=0;r<w;r++)n.push({tetromino:"none"});t.push(n)}for(var s=e.length-1;s>=0;s--)for(var o=e[s],i=o;i>=0;i--)for(var l=e.length-s,c=0;c<y;c++)i===o?t[c][i].tetromino="none":t[c][i+l].tetromino=this.props.matrix[c][i].tetromino;var h=0;switch(e.length){case 1:h=100*this.props.level;break;case 2:h=400*this.props.level;break;case 3:h=900*this.props.level;break;case 4:h=2e3*this.props.level;break;default:h=1e3;for(var u=5;u<=e.length;u++)h*=u;h*=this.props.level}this.props.dispatch(C(h)),this.props.dispatch(function(e,t){return{type:"COPY_MATRIX",newMatrix:e,lowerLine:t}}(t,e[e.length-1]));var m=this.props.level;this.props.dispatch({type:"ADD_LINES",lines:e.length}),this.props.level!==m&&this.props.dispatch({type:"REDUCE_GRAVITY",amount:Math.floor(1/(.65*m)*200)})}},{key:"turnTetrominoIntoCells",value:function(){var e=this.state.tetromino.cells,t=[];e.forEach(function(e){t.some(function(t){return e[1]===t})||t.push(e[1])});for(var a=[],n=0;n<t.length;n++){for(var r=!0,s=0;s<y;s++)if(this.props.matrix[s][t[n]]&&"none"===this.props.matrix[s][t[n]].tetromino){r=!1;break}r&&a.push(t[n])}0!==a.length&&this.linesAchieved(a.sort()),this.state.isMobile&&this.state.pushDown&&this.setState({pushDown:!1}),this.spawnNextTetromino(this.props.nextTetromino),this.props.dispatch({type:"LOAD_NEW_TETROMINO"})}},{key:"checkCollisionsByMoving",value:function(e,t,a){var n=this,r=a.position,s=a.tetrominoProps.shape[a.orientation],o=a.cells,i=!0;return s.some(function(a){var s=r[0]+a[0]+e;if(s<0||s>y-1)return i=!1,!0;var l=r[1]+a[1]+t;return l<0||l>w-1?(i=!1,!0):!o.some(function(e){return e[0]===s&&e[1]===l})&&"none"!==n.props.matrix[s][l].tetromino&&!n.props.matrix[s][l].ghost&&(i=!1,!0)}),i}},{key:"getCellsByMoving",value:function(e,t,a){var n=[];return a.shape[0].forEach(function(a){n.push([e+a[0],t+a[1]])}),n}},{key:"moveTetromino",value:function(e,t){var a=this.state.tetromino.position,n=this.checkCollisionsByMoving(e,t,this.state.tetromino);if(!n)return 1===t&&(this.turnTetrominoIntoCells(),!1);var r=a[0],s=a[1],o=[r+=e,s+=t],i=this.calculateGhostPieceY(this.state.tetromino,o),l=I(this.state.tetromino,o,this.props.dispatch,this.state.tetromino.orientation,i),c=Object(v.a)(l,2),h=c[0],u=c[1];return this.setState({tetromino:Object(d.a)({},this.state.tetromino,{cells:h,ghostCells:u,ghostPosition:[o[0],i],position:o})}),n}},{key:"rotationCalculations",value:function(e,t,a){return e<0||e>y-1?[!0,"no"]:t<0||t>w-1?[!0,"no"]:!a.some(function(a){return a[0]===e&&a[1]===t})&&"none"!==this.props.matrix[e][t].tetromino&&[!0,"no"]}},{key:"rotateTetromino",value:function(){var e=this,t=this.state.tetromino.orientation+1>3?0:this.state.tetromino.orientation+1,a=this.state.tetromino.position,n=this.state.tetromino.cells,r="yes";"I"===this.state.tetromino.type&&(10===a[0]&&3===this.state.tetromino.orientation||0===a[0]&&1===this.state.tetromino.orientation)&&(t=0===t?2:0,a=10===a[0]?[a[0]-1,a[1]]:[a[0]+1,a[1]]);var s=this.state.tetromino.tetrominoProps.shape[t];if(s.some(function(t){var s=a[0]+t[0],o=a[1]+t[1],i=e.rotationCalculations(s,o,n);return void 0!==i[1]&&(r=i[1]),i[0]}),"no"===r&&(r="right",s.some(function(t){var s=a[0]+t[0]+1,o=a[1]+t[1],i=e.rotationCalculations(s,o,n);return void 0!==i[1]&&(r=i[1]),i[0]}),"no"===r&&(r="left",s.some(function(t){var s=a[0]+t[0]-1,o=a[1]+t[1],i=e.rotationCalculations(s,o,n);return void 0!==i[1]&&(r=i[1]),i[0]}))),"no"!==r){var o=[a[0],a[1]];switch(r){case"right":o[0]+=1;break;case"left":o[0]-=1}var i=this.calculateGhostPieceY(this.state.tetromino,o,t),l=I(this.state.tetromino,o,this.props.dispatch,t,i),c=Object(v.a)(l,2),h=c[0],u=c[1];this.setState({tetromino:Object(d.a)({},this.state.tetromino,{position:o,cells:h,ghostCells:u,ghostPosition:[o[0],i],orientation:t})})}}},{key:"cleanCurrentTetromino",value:function(){var e,t;e=this.state.tetromino,(t=this.props.dispatch)(N(e.cells,"none")),t(N(e.ghostCells,"none"))}},{key:"holdTetromino",value:function(){var e=this.state.tetromino.type;this.setState({waitingToHold:!0}),this.cleanCurrentTetromino(),"none"!==this.props.tetrominoHeld?this.spawnNextTetromino(this.props.tetrominoHeld,!0):(this.spawnNextTetromino(this.props.nextTetromino,!0),this.props.dispatch({type:"LOAD_NEW_TETROMINO"})),this.props.dispatch({type:"HOLD",tetromino:e})}},{key:"dropItHard",value:function(){if(!(Date.now()-this.state.timeDropped<100)){var e=this.state.tetromino.ghostPosition[1]-this.state.tetromino.position[1];this.moveTetromino(0,e),this.moveTetromino(0,1);var t=e*this.props.level;this.props.dispatch(C(t)),this.setState({timeDropped:Date.now()})}}},{key:"calculateGhostPieceY",value:function(e,t,a){var n;n=e?Object.assign({},e):Object.assign({},this.state.tetromino);var r=t||n.position;n.position=r,"number"===typeof a&&(n.orientation=a);for(var s=r[1]+1;s<=w;s++)if(!this.checkCollisionsByMoving(0,s-r[1],n))return s-1}},{key:"handlePauseButton",value:function(){this.state.gameOver||(-1!==this.props.timer?(this.props.dispatch({type:"STOP_TIMER"}),this.setState({paused:!0})):(this.props.dispatch(S(60,this.gameTick)),this.setState({paused:!1})))}},{key:"handleKeyDown",value:function(e){if(!this.state.gameOver&&-1!==this.props.timer)switch(e.key){case"ArrowRight":this.setState({moveX:1});break;case"ArrowLeft":this.setState({moveX:-1});break;case"ArrowUp":this.state.canRotate&&this.setState({rotate:!0,canRotate:!1});break;case"ArrowDown":this.setState({pushDown:!0});break;case"c":this.state.waitingToHold||this.holdTetromino();break;case" ":this.setState({dropHard:!0})}}},{key:"handleKeyUp",value:function(e){if(!this.state.gameOver&&-1!==this.props.timer)switch(e.key){case"ArrowUp":this.state.canRotate||this.setState({canRotate:!0});break;case"ArrowDown":this.setState({pushDown:!1})}}},{key:"handleResize",value:function(){window.innerWidth<768?this.setState({isMobile:!0}):this.setState({isMobile:!1})}},{key:"handleFullscreenClick",value:function(){this.state.fullscreen?document.exitFullscreen():document.body.requestFullscreen()}},{key:"onFullscreenChange",value:function(){this.setState({fullscreen:!this.state.fullscreen})}},{key:"switchMute",value:function(){this.setState({storage:Object(d.a)({},this.state.storage,{mute:!this.state.mute}),mute:!this.state.mute})}},{key:"switchControls",value:function(){this.setState({showingControls:!this.state.showingControls})}},{key:"newRecord",value:function(){for(var e,t=this.props.score,a=this.state.storage.leaderboard,n=!1,r=0;r<a.length;r++)if(t>a[r].score){e=r,n=!0;break}return[n,e]}},{key:"setNewRecord",value:function(e,t){var a=this.state.storage.leaderboard.slice();a.splice(t,0,{name:e,score:this.props.score}),a.pop(),this.setState({storage:Object(d.a)({},this.state.storage,{leaderboard:a})}),localStorage.setItem("reactTetris",JSON.stringify(this.state.storage))}},{key:"render",value:function(){var e=this;if(!this.state.running&&!this.state.gameOver)return r.a.createElement("div",{id:"Start",className:"unselectable container",style:{maxWidth:"unset",backgroundColor:"#4c64ff"}},r.a.createElement("div",{className:"col-xs-12",style:{textAlign:"center"}},r.a.createElement("h1",{id:"Title"},r.a.createElement("p",{style:{color:"red",display:"inline"}},"t"),r.a.createElement("p",{style:{color:"rgb(224, 146, 0)",display:"inline"}},"e"),r.a.createElement("p",{style:{color:"yellow",display:"inline"}},"t"),r.a.createElement("p",{style:{color:"lime",display:"inline"}},"r"),r.a.createElement("p",{style:{color:"cyan",display:"inline"}},"i"),r.a.createElement("p",{style:{color:"#d800d8",display:"inline"}},"s")),r.a.createElement("button",{id:"StartButton",className:"btn btn-success",onClick:this.startGame},"START"),r.a.createElement(E,{startScreen:!0,isMobile:this.state.isMobile,open:this.state.showingControls,handler:this.switchControls})));null!==this._music.current&&(this._music.current.paused&!this.state.mute?this._music.current.play():!this._music.current.paused&this.state.mute&&this._music.current.pause());var t=r.a.createElement(K,{paused:this.state.paused,handler:this.handlePauseButton,isMobile:this.state.isMobile,controlHandler:this.switchControls,openControls:this.state.showingControls,backToStart:this.returnToStartMenu}),a=r.a.createElement(J,{gameOver:this.state.gameOver,restartGameHandler:this.restartGame,startScreenHandler:this.returnToStartMenu,leaderboardData:this.state.storage.leaderboard,newRecord:this.newRecord,setNewRecord:this.setNewRecord}),n=r.a.createElement("div",{id:"MobileControls"},r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",onClick:function(){e.state.canRotate&&e.setState({rotate:!0})}},r.a.createElement("i",{className:"fas fa-sync-alt"})),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.setState({moveX:-1})}},r.a.createElement("i",{className:"fas fa-arrow-left"})),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.setState({moveX:1})}},r.a.createElement("i",{className:"fas fa-arrow-right"}))),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",style:this.state.pushDown?{backgroundColor:"black",color:"white"}:{},onClick:function(){return e.setState({pushDown:!e.state.pushDown})}},r.a.createElement("i",{className:"fas fa-chevron-down"})),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.setState({dropHard:!0})}},r.a.createElement("i",{className:"fas fa-level-down-alt"})),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){e.state.waitingToHold||e.holdTetromino()}},r.a.createElement("i",{className:"fas fa-briefcase"}))));return this.state.isMobile?r.a.createElement("div",{id:"Game",className:"unselectable container"},r.a.createElement("audio",{ref:this._music,src:"./soundtrack.mp3",loop:!0}),r.a.createElement("div",{id:"Panel",className:"col-xs-12 col-md-3"},r.a.createElement("div",{className:"col-xs-2 col-md-12",id:"left-panel"},r.a.createElement(L,null),r.a.createElement("div",null,t,r.a.createElement(X,{mute:this.state.mute,handler:this.switchMute}),r.a.createElement(W,{fullscreen:this.state.fullscreen,handler:this.handleFullscreenClick}))),r.a.createElement("div",{className:"col-xs-8 col-md-12"},r.a.createElement(F,null),r.a.createElement(P,null))),r.a.createElement("div",{id:"social-buttons"},r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/tomas302"},r.a.createElement("i",{className:"fab fa-github"})),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.linkedin.com/in/tom%C3%A1s-dornell-bonilla-b64a62177/"},r.a.createElement("i",{className:"fab fa-linkedin"})),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://tomas302.github.io/"},r.a.createElement("i",{className:"fas fa-user-circle"}))),r.a.createElement("div",{className:"col-xs-12 col-md-5",style:{display:"flex",justifyContent:"center"}},r.a.createElement(T,{gestureListener:this.listenForGestures,ref:this._matrix})),n,a):(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(n=[]),r.a.createElement("div",{id:"Game",className:"unselectable"},r.a.createElement("audio",{ref:this._music,src:"./soundtrack.mp3",loop:!0}),r.a.createElement("div",{id:"left-panel"},r.a.createElement(L,null),r.a.createElement(F,null)),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},r.a.createElement(T,{gestureListener:this.listenForGestures,ref:this._matrix}),n,r.a.createElement("div",{id:"social-buttons"},r.a.createElement("h5",null,"Coded by Tom\xe1s Dornell"),r.a.createElement("h6",null,"Check me out!"),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/tomas302"},r.a.createElement("i",{className:"fab fa-github"})),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.linkedin.com/in/tom%C3%A1s-dornell-bonilla-b64a62177/"},r.a.createElement("i",{className:"fab fa-linkedin"})),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://tomas302.github.io/"},r.a.createElement("i",{className:"fas fa-user-circle"})))),r.a.createElement("div",{id:"right-panel"},r.a.createElement("div",{className:"row"},t,r.a.createElement(X,{mute:this.state.mute,handler:this.switchMute})),r.a.createElement("div",{className:"row"},r.a.createElement(P,null))),a))}}]),t}(n.Component),q=Object(p.b)()(Z);var $=Object(p.b)(function(e){return{gameKey:e.gameKey,score:e.stats.score,matrix:e.matrix,nextTetromino:e.nextTetrominos[0],timer:e.timer,tetrominoHeld:e.holding,level:e.stats.level,gravityInterval:e.gravityInterval}})(q),Q=a(12);window.accurateInterval=function(e,t){var a,n,r,s;return n=(new Date).getTime()+t,r=null,s=function(){return n+=t,r=setTimeout(s,n-(new Date).getTime()),e()},a=function(){return clearTimeout(r)},r=setTimeout(s,n-(new Date).getTime()),{cancel:a}};var ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_TIMER":return window.accurateInterval(t.fn,t.delay);case"STOP_TIMER":return-1===e?-1:(e.cancel(),-1);default:return e}},te=function(){for(var e=[],t=0;t<y;t++){for(var a=[],n=0;n<w;n++)a.push({tetromino:"none"});e.push(a)}return e},ae=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te(),a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"RESET_GAME_STATE":return te();case"CHANGE_MATRIX":e=Object.assign({},t);for(var n=0;n<a.cells.length;n++){var r=a.cells[n];if(e[r[0]][r[1]])if(a.ghost){if("none"!==e[r[0]][r[1]].tetromino&&!e[r[0]][r[1]].ghost)continue;e[r[0]][r[1]].ghost=!0,e[r[0]][r[1]]&&(e[r[0]][r[1]].tetromino=a.tetromino)}else if(e[r[0]][r[1]].ghost){if("none"!==e[r[0]][r[1]].tetromino&&!e[r[0]][r[1]].ghost)continue;e[r[0]][r[1]].ghost=void 0,e[r[0]][r[1]].tetromino=a.tetromino}else e[r[0]][r[1]].tetromino=a.tetromino}return e;case"COPY_MATRIX":e=a.newMatrix;var s=a.lowerLine;if(s+1<w){for(var o=s+1;o<w;o++)for(var i=0;i<y;i++)e[i][o].tetromino=t[i][o].tetromino;return e}return e;default:return t}},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_NEXT_TETROMINOS":return M(3,[t.currentTetro]);case"LOAD_NEW_TETROMINO":return[e[1],e[2],M(null,e)];default:return e}},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"none",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HOLD":return t.tetromino;default:return e}},se={score:0,level:1,lines:0},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_SCORE":return Object(d.a)({},e,{score:e.score+t.points});case"ADD_LINES":var a,n=e.lines.toString(),r=(e.lines+t.lines).toString();return n.length>1?r[n.length-2]>n[n.length-2]&&(a=r[n.length-2]-n[n.length-2]):r.length>1&&(a=r.length-1),Object(d.a)({},e,{lines:e.lines+t.lines,level:e.level+(void 0!==a?a:0)});default:return e}},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REDUCE_GRAVITY":var a=e-t.amount;return a<60?60:a;default:return e}},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"RESET_GAME_STATE"===t.type&&(e=t.gameKey+1),e},ce=function(e,t){return"RESET_GAME_STATE"===t.type&&(e=void 0),he(e,t)},he=Object(Q.b)({gameKey:le,timer:ee,matrix:ae,nextTetrominos:ne,holding:re,stats:oe,gravityInterval:ie}),ue=ce,me=Object(Q.c)(ue);document.addEventListener("touchmove",function(e){1!==(e=e.originalEvent||e).scale&&e.preventDefault()},!1);var pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).state={startAgain:!1},a.refreshApp=a.refreshApp.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"refreshApp",value:function(e){this.forceUpdate(),this.setState({startAgain:e})}},{key:"render",value:function(){return r.a.createElement(p.a,{store:me},r.a.createElement("div",{id:"App"},r.a.createElement($,{key:me.getState().gameKey,refreshApp:this.refreshApp,running:this.state.startAgain})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[25,2,1]]]);
//# sourceMappingURL=main.c6dfff85.chunk.js.map